{% extends 'base.html' %}

{% block content %}
<!DOCTYPE html>
<html lang="es">
  <head>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.umd.min.js"></script>
    <style>
      .btn-action {
        border: none;
        background: none;
        cursor: pointer;
        margin: center;
        margin-right: 10px; /* Adjust the spacing here */
      }

      .btn-action i.fa-trash {
        color: red;
      }

      .btn-action i.fa-edit {
        color: blue;
      }

      .btn-action i.fa-image {
        color: purple;
      }

      .code-list {
        list-style-type: none;
        padding: 0;
        margin: 0;
      }

      .code-list li {
        display: flex;
        align-items: center;
      }

      .code-list li i {
        margin-right: 8px;
      }

      .fa-save {
        color: blue;
      }

      .fa-barcode {
        color: red;
      }

      .fa-box {
        color: red;
      }
      .fa-eye {
        color: red;
      }
      .nav-button {
        position: relative;
      }

      .submenu {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        background: #f9f9f9;
        border: 1px solid #ccc;
        padding: 10px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }

      .nav-button:hover .submenu {
        display: block;
      }

      .submenu-item {
        display: flex;
        align-items: center;
        padding: 5px 0;
      }

      .submenu-item i {
        margin-right: 8px;
      }

      .submenu-item:hover {
        background-color: #007bff; /* Color azul para el hover */
        color: #fff; /* Cambia el color del texto a blanco para mejor legibilidad */
    }

      .btn-action {
        background-color: #b6d1ee;
        color: white;
        border: none;
        padding: 10px 20px;
        cursor: pointer;
        font-size: 16px;
        border-radius: 5px;
      }
     
      /* Estilos para el modal */
.modal-imagen-tabla {
  display: none;
  position: fixed; /* Posicionar el modal en la pantalla */
  z-index: 1; /* Mostrar el modal encima de otros elementos */
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5); /* Fondo oscuro */
  display: flex; /* Utilizar flexbox para centrar el contenido */
  justify-content: center; /* Centrar horizontalmente */
  align-items: center; /* Centrar verticalmente */
}

/* Estilos para el contenido del modal */
.modal-imagen-tabla .modal-content {
  display: block;
  width: 80%;
  max-width: 700px;
  margin: auto; /* Centrar el contenido dentro del contenedor */
}

/* Estilos para el botón de cerrar */
.modal-imagen-tabla .close {
  position: absolute;
  top: 15px;
  right: 35px;
  color: white;
  font-size: 40px;
  font-weight: bold;
  cursor: pointer;
}

.modal-ojo-producto {
  display: none; 
  position: fixed; 
  z-index: 1; 
  left: 0;
  top: 0;
  width: 100%; 
  height: 100%; 
  overflow: auto; 
  background-color: rgba(0, 0, 0, 0.5); 
  justify-content: center;
  align-items: center;
}

.modal-ojo-producto .modal-content {
  background-color: #fefefe;
  margin: auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
  max-width: 600px;
  border-radius: 10px;
}

.modal-ojo-producto .close {
  color: #aaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.modal-ojo-producto .close:hover,
.modal-ojo-producto .close:focus {
  color: black;
  text-decoration: none;
  cursor: pointer;
}

@media (min-width: 1200px) {
  .h2, h2 {
      color: orange;
      font-size: 2rem;
  }
}

.hidden {
  display: none;
}

.icono-caja-abierta {
  font-size: 36px; /* Tamaño del ícono */
  color: #865a27e7; /* Color del ícono */
  margin-right: 10px; /* Espacio entre el ícono y el texto */
  vertical-align: middle; /* Alineación vertical con el texto */
}

    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <div class="nav-buttons">
          <button type="button" class="nav-button">
            <span class="icon">&#9776;</span>
            <span class="text">MIS PRODUCTOS</span>
          </button>
          <button type="button" class="nav-button">
            <span class="icon">&#8645;</span>
            <span class="text">AJUSTES INVENTARIO</span>
            <div class="submenu">
              <div class="submenu-item">
                <i class="fas fa-print"></i> Imprimir
              </div>
              <div class="submenu-item">
                <i class="fas fa-download"></i> Descargar
              </div>

          </button>
          <button type="button" class="nav-button">
            <span class="icon">&#128190;</span>
            <span class="text">CATÁLOGO CABYS</span>
            <div class="submenu">
              <div class="submenu-item">
                <i class="fas fa-download"></i> Cargar archivo
              </div>
          </button>
          
          <button type="button" class="nav-button" onclick="generarReportePDF()" onclick="event.preventDefault(); window.open(this.href, '_blank');">
            <span class="icon"><i class="fas fa-file-pdf"></i></span>
            <span class="text">REPORTES</span>
          </button>
          
        </div>
        <div class="search-bar">
          <input type="text" placeholder="Busca producto por código o nombre" />
          <button type="button">&#128269;</button>
          <!-- Icono de búsqueda -->
        </div>
      </div>
      <div class="pagination">
        <span> 3 - 3 de 28</span>
        <button type="button" class="pagination-button">&#9664;</button>
        <span>1</span>
        <button type="button" class="pagination-button">&#9654;</button>
      </div>
    </div>
    <div class="product-table">
      <table>
        <thead>
          <tr>
            <th>Códigos</th>
            <th>Nombre</th>
            <th>Cantidad</th>
            <th>Estado</th>
            <th>Precio(s)</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <ul class="code-list">
                <li><i class="fas fa-box"></i> SC3497-4</li>
                <li><i class="fas fa-barcode"></i> SC3748-2</li>
                <li><i class="fas fa-save"></i> SC9101-1</li>
              </ul>
            </td>
            <td>PINTURA SEAL COAT SATIN ACCENT 1 GL LANCO</td>
            <td data-inventory="20.00">20.00</td>
            <td class="alert-cell"></td>
            <td>
              <div>Venta Regular al publico: <strong>174,497.00</strong></div>
              <div>Costo del producto: <strong>66,160.00</strong></div>
            </td>
            <td>
              <button class="btn-action">
                <i class="fas fa-trash"></i>
              </button>
              <button class="btn-action">
                <i class="fas fa-edit"></i>
              </button>
              <button class="btn-action btn-image">
                <i class="fas fa-image"></i>
              </button>
              <button class="btn-action">
                <i class="fas fa-eye"></i> <!-- Nuevo botón para "Ver detalles" -->
              </button>
            </td>
          </tr>
          <tr>
            <td>
              <ul class="code-list">
                <li><i class="fas fa-box"></i> SC3497-4</li>
                <li><i class="fas fa-barcode"></i> SC3748-2</li>
                <li><i class="fas fa-save"></i> SC9101-1</li>
              </ul>
            </td>
            <td>PINTURA SUPER COAT SATIN BLANCO 1 CUB</td>
            <td data-inventory="1.00">1.00</td>
            <td class="alert-cell"></td>
            <td>
              <div>Venta Regular al publico: <strong>67,950.00</strong></div>
              <div>Costo del producto: <strong>40,879.00</strong></div>
            </td>
            <td>
              <button class="btn-action">
                <i class="fas fa-trash"></i>
              </button>
              <button class="btn-action">
                <i class="fas fa-edit"></i>
              </button>
              <button class="btn-action" onclick="openModal()">
                <i class="fas fa-image"></i>
              </button>
              <button class="btn-action">
                <i class="fas fa-eye"></i> <!-- Nuevo botón para "Ver detalles" -->
              </button>
              
              <div id="modal-imagen-tabla" class="modal-imagen-tabla">
                <span class="close" onclick="closeModal()">&times;</span>
                {% load static %}
               <img src="{% static 'img/pintura.jpg' %}" alt="Question Image" />
              </div>
            </td>
          </tr>
          <tr>
            <td>
              <ul class="code-list">
                <li><i class="fas fa-box"></i> SC3497-4</li>
                <li><i class="fas fa-barcode"></i> SC3748-2</li>
                <li><i class="fas fa-save"></i> SC9101-1</li>
              </ul>
            </td>
            <td>PINTURA SUPER COAT SATIN BLANCO 1 CUB</td>
            <td data-inventory="150.00">150.00</td>
            <td class="alert-cell"></td>
            <td>
              <div>Venta Regular al publico: <strong>67,950.00</strong></div>
              <div>Costo del producto: <strong> 40,879.00</strong></div>
            </td>
            <td>
              <button class="btn-action">
                <i class="fas fa-trash"></i>
              </button>
              <button class="btn-action">
                <i class="fas fa-edit"></i>
              </button>
              <button class="btn-action">
                <i class="fas fa-image"></i>
              </button>
              <button class="btn-action" onclick="openDetailsModal('PINTURA SEAL COAT SATIN ACCENT 1 GL LANCO', '20.00', 'Litros', 'Pintura satinada de alta calidad')">
              <i class="fas fa-eye"></i>
            </button> 
            </td>
          </tr>
          <!-- Add more rows as needed -->
        </tbody>
      </table>
    </div>
    <button
      class="add-button btn btn-success"
      data-toggle="modal"
      data-target="#productModal"><i class="fa fa-plus"></i></button>

   
      <div id="modal-ojo-producto" class="modal-ojo-producto">
        <div class="modal-content">
          <span class="close" onclick="closeDetailsModal()">&times;</span>
          <h2>Detalles del Producto</h2>
          <p id="detalle-nombre"><strong>Nombre:</strong> <span id="detalle-nombre-text"></span></p>
          <p id="detalle-cantidad"><strong>Cantidad:</strong> <span id="detalle-cantidad-text"></span></p>
          <p id="detalle-unidad-medida"><strong>Unidad de Medida:</strong> <span id="detalle-unidad-medida-text"></span></p>
          <p id="detalle-descripcion"><strong>Descripción:</strong> <span id="detalle-descripcion-text"></span></p>
          <p id="detalle-Moneda-Precio"><strong>Moneda de Precio: </strong><p> COLONES </p> <span id="detalle-descripcion-text"></span></p>
          <p id="detalle-Moneda-Precio"><strong>Precio de Venta Regular:</strong><p> 14 500 </p> <span id="detalle-descripcion-text"></span></p>
          <p id="detalle-Moneda-Precio"><strong>Calculo : </strong> <p> 18 500 </p> <span id="detalle-descripcion-text"></span></p>
          <p id="detalle-Moneda-Precio"><strong>Tipo de producto/servicio: </strong><p> Simple </p> <span id="detalle-descripcion-text"></span></p>
          <p id="detalle-Moneda-Precio"><strong>Impuestos: </strong> <p> Gravado </p> <span id="detalle-descripcion-text"></span></p>
        </div>
      </div>


  </div>
     <div
      class="modal fade"
      id="productModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="productModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="productModalLabel">
              <i class="fas fa-box-open icono-caja-abierta"></i>Formulario de Producto
            </h5>
            
          </div>
          <div class="modal-body">
            <!-- Formulario de Producto -->
            <div class="container">
              <h2>Información Básica</h2>
              <div class="form-group">
                <label for="nombre">Nombre</label>
                <input
                  type="text"
                  id="nombre"
                  name="nombre"
                  class="form-control"
                />
                <div class="form-group">
                  <label for="nombre">Cantidad</label>
                  <input
                    type="text"
                    id="nombre"
                    name="nombre"
                    class="form-control"
                  />
                <div class="form-group">
                  <label for="unidad-medida">Unidad de medida</label>
                  <input
                    type="text"
                    id="unidad-medida"
                    name="unidad-medida"
                    class="form-control"
                  />
                </div>
              </div>
              <div class="form-group">
                <label for="descripcion">Descripción (opcional)</label>
                <input
                  type="text"
                  id="descripcion"
                  name="descripcion"
                  class="form-control"
                />
              </div>
              <div class="form-group">
                <label for="codigo"
                  >Código CABYS del Catálogo de Bienes y Servicios</label
                >
                <input
                  type="text"
                  id="codigo"
                  name="codigo"
                  class="form-control"
                />
                <span class="error text-danger">Código CABYS es requerido</span>
              </div>
              <button type="button" class="btn" onclick="showSelect()">Agregar Otro Código</button>
              <div class="select-container" id="codeSelect">
                <label for="codigo-select">Seleccione un código:</label>
                <select id="codigo-select" onchange="mostrarCampoCodigo()">
                  <option value="Ninguno">Ninguno</option>
                  <option value="codigo-barra">Código de Barra</option>
                  <option value="otro-codigo">Otro Código</option>
                </select>
              </div>
              
              <div class="codigo-input-container hidden" id="codigoInputContainer">
                <label for="codigo-input">Ingrese el código:</label>
                <input type="text" id="codigo-input">
              </div>
 
              <br />
              <div class="form-group">
                <label for="imagenes">Imágenes del Producto</label>
                <label class="file-label" for="imagenes"
                  >Subir archivos...</label
                >
                <input
                  type="file"
                  id="imagenes"
                  name="imagenes"
                  class="file-input"
                />
              </div>
              <div class="form-group">
                <label for="moneda">Moneda de precios</label>
                <input
                  type="text"
                  id="moneda"
                  name="moneda"
                  class="form-control"
                />
              </div>
              <div class="form-group">
                <p>Costo</p>
                <label for="precio">Precio del Costo</label>
                <input
                  type="number"
                  id="precio"
                  name="precio"
                  value="0"
                  class="form-control"
                />
              </div>
              <h2>Precios de Venta</h2>
              <div class="form-group">
                <label for="Preios-regular">Precio Venta Regular</label>
                <input
                  type="text"
                  id="Precios-regular"
                  name="Precios-regular"
                  class="form-control"
                />
              </div>
              <div class="form-group">
                <label for="Precios">calculo</label>
                <input
                  type="number"
                  id="calculo"
                  name="Precios"
                  value="0"
                  class="form-control"
                />
              </div>
              <div class="form-group">
                <label for="Preios-regular">Precio Venta Especial</label>
                <input
                  type="text"
                  id="Precios-regular"
                  name="Precios-regular"
                  class="form-control"
                />
              </div>
              <div class="form-group">
                <label for="Precios">calculo</label>
                <input
                  type="number"
                  id="calculo"
                  name="Precios"
                  value="0"
                  class="form-control"
                />
              </div>

              <div class="form-group">
                <label for="descuento">Descuento por defecto</label>
                <input
                  type="number"
                  id="descuento"
                  name="descuento"
                  value="0"
                  class="form-control"
                />
              </div>
              <div class="form-group">
                <label>Tipo de Producto/Servicio</label>
                <div class="btn-group">
                  <button type="button" class="btn btn-secondary selected">
                    Simple
                  </button>
                  <button type="button" class="btn btn-secondary">
                    Compuesto
                  </button>
                </div>
                <div class="form-group">
                  <span
                    >Simple: *Productos individuales que tienen su propio
                    inventario*</span
                  ><br />
                  <span
                    >Compuesto: *Este producto agrupa varios productos simples
                    bajo un solo ítem.*</span
                  >
                </div>
              </div>
              <label>INVENTARIO : </label>
              <div class="form-group form-check">
                <input
                  type="checkbox"
                  id="inventario"
                  name="inventario"
                  class="form-check-input"
                />
                <label for="inventario" class="form-check-label"
                  >Seguimiento de inventario</label
                >
              </div>

              <div class="form-group">
                <label for="Clasificacion-etiqueta">Clasificacion</label>
                <input
                  type="text"
                  id="Clasificacion-etiqueta"
                  name="Clasificacion-etiqueta"
                  class="form-control"
                />
                <p>Utiliza las etiquetas para clasificar este producto.</p>
              </div>
              <div class="form-group">
                <label>Impuestos</label>
                <p>Este Productio Esta</p>
                <div class="btn-impuestos-group">
                  <button type="button" class="btn btn-secondary selected">
                    Exento
                  </button>
                  <button type="button" class="btn btn-secondary">
                    Gravado
                  </button>
                </div>
              </div>
              <div class="save-button">
                <button type="button" class="btn btn-primary">GUARDAR</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    </div>


    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
      

      document.querySelectorAll(".btn-group button").forEach((button) => {
        button.addEventListener("click", () => {
          document
            .querySelectorAll(".btn-group button")
            .forEach((btn) => btn.classList.remove("selected"));
          button.classList.add("selected");
        });
      });
      document
        .querySelectorAll(".btn-impuestos-group button")
        .forEach((button) => {
          button.addEventListener("click", () => {
            document
              .querySelectorAll(".btn-impuestos-group button")
              .forEach((btn) => btn.classList.remove("selected"));
            button.classList.add("selected");
          });
        });

      document.addEventListener('DOMContentLoaded', function () {
        const alertCells = document.querySelectorAll('.alert-cell');

        alertCells.forEach(function (cell) {
          const inventory = parseFloat(
            cell.previousElementSibling.getAttribute('data-inventory')
          );

          if (inventory <= 10) {
            cell.innerHTML = '<span style="color: red;"><i class="fas fa-exclamation-triangle"></i> Stock bajo</span>';
          } else if (inventory > 10 && inventory <= 100) {
            cell.innerHTML = '<span style="color: green;"><i class="fas fa-check-circle"></i> Inventario normal</span>';
          } else if (inventory > 100) {
            cell.innerHTML = '<span style="color: blue;"><i class="fas fa-money-bill-wave"></i> Excedente inventario</span>';
          }
        });
      });

      
      function openModal() {
        document.getElementById("modal-imagen-tabla").style.display = "flex";
      }
      
      function closeModal() {
        document.getElementById("modal-imagen-tabla").style.display = "none";
      }
      
      // Asegurarse de que el modal esté oculto al cargar la página
    document.addEventListener("DOMContentLoaded", function() {
      document.getElementById("modal-imagen-tabla").style.display = "none";
    });

    function generarReportePDF() {
      // Importar jsPDF
      const { jsPDF } = window.jspdf;

      
      
      
      // Crear una instancia de jsPDF
      const doc = new jsPDF();

      // Título del documento
      doc.setFontSize(20);

      doc.text('Reporte de Productos', 20, 20);

      // Agregar el contenido de la tabla
      let startY = 30; // Punto inicial en el eje Y
      const margin = 10; // Margen izquierdo
      
      // Obtener los datos de la tabla
      const rows = document.querySelectorAll('table tbody tr');
      
      rows.forEach((row, index) => {
        const columns = row.querySelectorAll('td');
        
        columns.forEach((col, colIndex) => {
          let text = col.innerText || '';
          doc.setFontSize(12); // Tamaño de fuente para el contenido
          doc.text(text, margin + colIndex * 50, startY + index * 10);
        });
      });
      
      
      // Descargar el PDF
      event.preventDefault(); 
      window.open(this.href, '_blank');
      doc.save('reporte_productos.pdf');
    }

    function openDetailsModal(nombre, cantidad, unidadMedida, descripcion) {
      document.getElementById("detalle-nombre-text").innerText = nombre;
      document.getElementById("detalle-cantidad-text").innerText = cantidad;
      document.getElementById("detalle-unidad-medida-text").innerText = unidadMedida;
      document.getElementById("detalle-descripcion-text").innerText = descripcion;
      document.getElementById("modal-ojo-producto").style.display = "flex";
    }
  
    function closeDetailsModal() {
      document.getElementById("modal-ojo-producto").style.display = "none";
    }
  
    // Asignar el evento a los botones de "ver detalles"
    document.querySelectorAll(".btn-action .fa-eye").forEach(button => {
      button.addEventListener("click", function() {
        const row = this.closest("tr");
        const nombre = row.querySelector("td:nth-child(2)").innerText;
        const cantidad = row.querySelector("td:nth-child(3)").innerText;
        const unidadMedida = row.querySelector("td:nth-child(4)").innerText;
        const descripcion = row.querySelector("td:nth-child(5)").innerText;
  
        openDetailsModal(nombre, cantidad, unidadMedida, descripcion);
      });
    });

    function mostrarCampoCodigo() {
      var select = document.getElementById("codigo-select");
      var inputContainer = document.getElementById("codigoInputContainer");
      
      if (select.value === "codigo-barra" || select.value === "otro-codigo") {
        inputContainer.classList.remove("hidden");
      } else {
        inputContainer.classList.add("hidden");
      }
    }
    </script>
  </body>
</html>
{% endblock %}